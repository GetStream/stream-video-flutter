# StreamCallContainer

The `StreamCallContainer` widget is an all-encompassing widget that can handle all stages of a call: incoming,
outgoing and active call screens. The individual screens also contain everything required to manage the call
such as call controls on the active call screen as well as accept and hang up buttons on the incoming and outgoing screens.

The `StreamCallContainer` has three components:

1. Incoming Call: Shows an incoming call to the user with the options to accept or reject the call.
2. Outgoing Call: Shows the person being called by the user along with an end call button.
3. Active Call: Displays the active call with videos of participants and call controls which allow the user
to enable/disable audio and video, as well as leave the call. Also contains an `AppBar` which contains
basic info about the call along with the list of participants in the call available via a button.

## Usage

To use `StreamCallContainer`, pass in the `Call` object you want to use for the call. Pass in a `CallConnectOptions`
object which determines if video, audio, and screen-share are enabled by default.


```dart
    final callConnectOptions = CallConnectOptions();

    StreamCallContainer(
        call: call,
        callConnectOptions: callConnectOptions,
    ),
```

This is how the screen flow looks when handling a call:

* Incoming Call

// TODO: Add image

* Active Call

// TODO: Add image

* Outgoing Call

// TODO: Add image

## Customization

The `StreamCallContainer` contains several customisation options that let you modify the content of the individual
screens as well as the behaviours of some actions.

### Modifying screen content

Each of the three screens (incoming, active call, and outgoing) allows you to modify the content displayed
on the screen so you can build the screen to fit your application. To do this, modify the `incomingCallBuilder`,
`callContentBuilder`, and `outgoingContentBuilder` respectively.

As an example, here's how you would modify the incoming call screen:

```dart
    StreamCallContainer(
        call: call,
        callConnectOptions: callConnectOptions,
        incomingCallBuilder: (context, call, state) {
          // Build your screen here
          return Scaffold();
        },
    ),
```

You may also want to modify something smaller about the screens instead of replacing it entirely.
In order to achieve this, the SDK also provides the screens as individual widgets. The incoming call
screen is defined by the `StreamIncomingCallContent` widget, the active call screen by `StreamCallContent`,
and the outgoing screen by `StreamOutgoingCallContent`.

To use the predefined screen in the previous example, you can do:

```dart
    StreamCallContainer(
        call: call,
        callConnectOptions: callConnectOptions,
        incomingCallBuilder: (context, call, callState) {
          return StreamIncomingCallContent(
            call: call,
            callState: callState,
          );
        },
    ),
```

Using the predefined widget, you can also modify other aspects of the screen that you cannot otherwise modify.

### Modifying call controls

To modify the call controls, you first need to use the `callContentBuilder` in the `StreamCallContainer`.
You can then use a `StreamCallContent` widget to modify the call controls:

```dart
    StreamCallContainer(
      call: call,
      callConnectOptions: callConnectOptions,
      callContentBuilder: (context, call, callState) {
        return StreamCallContent(
          call: call,
          callState: callState,
          callControlsBuilder: (context, call, callState) {
            return StreamCallControls.withDefaultOptions(
              call: call,
              localParticipant: callState.localParticipant!,
            );
          },
        );
      },
    ),
```

You can then modify visual aspects of the call controls:

```dart
    StreamCallContainer(
      call: call,
      callConnectOptions: callConnectOptions,
      callContentBuilder: (context, call, callState) {
        return StreamCallContent(
          call: call,
          callState: callState,
          callControlsBuilder: (context, call, callState) {
            return StreamCallControls.withDefaultOptions(
              call: call,
              localParticipant: callState.localParticipant!,
              backgroundColor: Colors.blue,
              elevation: 24.0,
              spacing: 4.0,
            );
          },
        );
      },
    ),
```

### Modifying call options

When on any one of the three screens, the user sees options that help them accept, decline, leave, or cancel
a call. When any of these actions are triggered, you may want to modify the flow or run additional code.
To help you achieve this, there are callbacks you can define in the `StreamCallContainer` which run in place
of the existing code. Additionally, there is also a callback that can be defined which allows you to replace
the behaviour for when the back button is pressed on the `AppBar`.

Here are the callbacks you can define for the widget:

```dart
    StreamCallContainer(
        call: call,
        callConnectOptions: callConnectOptions,
        onBackPressed: () {},
        onAcceptCallTap: () {},
        onDeclineCallTap: () {},
        onCancelCallTap: () {},
        onLeaveCallTap: () {},
    ),
```